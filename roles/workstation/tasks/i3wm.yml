- name: install the i3 window manager packages
  dnf: name={{ item }}
       state=present
  ignore_errors: yes
  with_items:
    - i3
    - i3-doc
    - i3-ipc
    - i3lock
    - i3status
    - rofi
    - lightdm
    - thunar
    - lxrandr
    - xbacklight
    - blueman
    - feh
    - scrot
    - ImageMagick
    - acpi
    - python3-tkinter

- name: check if i3blocks is downloaded and compiled
  raw: "[ -f /usr/local/bin/i3blocks ]"
  register: i3blocks_done
  ignore_errors: true

- name: git clone i3blocks
  git:
    repo: "https://github.com/vivien/i3blocks.git"
    dest: /tmp/i3blocks
  ignore_errors: yes
  when: i3blocks_done|failed

- name: compile and install i3blocks
  raw: cd /tmp/i3blocks && make clean all && make install
  ignore_errors: yes
  when: i3blocks_done|failed

- name: disable gdm
  systemd:
    name: gdm
    enabled: no

- name: enable lightdm
  systemd:
    name: lightdm
    enabled: yes

- name: make sure ~/bin exists
  file:
    path: /home/{{ user }}/bin
    state: directory
    owner: "{{ user }}"
    group: "{{ user }}"

- name: copy lock.sh to ~/bin
  copy:
    src: bin/lock.sh
    dest: /home/{{ user }}/bin/lock.sh
    owner: "{{ user }}"
    group: "{{ user }}"
    mode: 0700

- name: copy wallpaper to ~/.wallpaper
  copy:
    src: wallpaper/star-trek-beyond.jpg
    dest: /home/{{ user }}/.wallpaper.jpg
    owner: "{{ user }}"
    group: "{{ user }}"
    mode: 0644

